<div class="dashboard-container">

  <!-- HEADER -->
  <div class="dashboard-header">
    <div>
      <h2>Welcome, {{ userName }}</h2>
      <p class="sub">
        {{ roleName }} â€¢ {{ companyName }}
      </p>
    </div>

    <div class="quick-actions">
      <a routerLink="/tasks" class="btn-primary"> <i class="bi bi-plus"></i> New Task</a>
      <a routerLink="/requirements/add" class="btn-ghost"> <i class="bi bi-plus"></i> New Requirement</a>
      <a routerLink="/teams" class="btn-ghost"> <i class="bi bi-people"></i>Teams</a>
    </div>
  </div>

  <!-- STATS -->
  <div class="col-xl-3 col-lg-4 col-md-6 col-12">
    <div class="stats-grid" *ngIf="!loadingCounters">
      <div class="stat-card" (click)="openTasks('pending')">
        <span class="label">Pending</span>
        <span class="value">{{ counters.pending }}</span>
      </div>
      <div class="stat-card" (click)="openTasks('wip')">
        <span class="label">In Progress</span>
        <span class="value">{{ counters.wip }}</span>
      </div>
      <div class="stat-card" (click)="openTasks('completed')">
        <span class="label">Completed</span>
        <span class="value">{{ counters.completed }}</span>
      </div>
      <div class="stat-card danger" (click)="openTasks('overdue')">
        <span class="label">Overdue</span>
        <span class="value">{{ counters.overdue }}</span>
      </div>
    </div>
  </div>

  <!-- RECENT TASKS -->
  <div class="recent-tasks">
    <h3>My Recent Tasks</h3>

    <div *ngIf="loadingRecent" class="loading">Loading tasks...</div>

    <div *ngIf="!loadingRecent && recentTasks.length === 0" class="empty">
      No tasks assigned yet
    </div>

    <ul *ngIf="recentTasks.length">
      <li *ngFor="let task of recentTasks">
        <div>
          <div class="task-title">{{ task.module }}</div>
          <div class="task-desc">{{ task.description || 'No description' }}</div>
        </div>

        <div class="task-right">
          <span class="status" [ngClass]="task.status.toLowerCase().replace(' ', '-')">
            {{ task.status }}
          </span>
          <small>Due {{ task.endDate | date:'mediumDate' }}</small>
        </div>
      </li>
    </ul>
  </div>

</div>

<!-- TASK MODAL -->
<app-task-modal
  *ngIf="showModal"
  [title]="modalTitle"
  [tasks]="modalTasks"
  [loading]="loadingTasks"
  (close)="closeModal()">
</app-task-modal>

